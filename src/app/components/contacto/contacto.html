<section class="py-5 animate__animated animate__fadeIn">
  <div class="container">
    <div class="text-center mb-5">
      <h1 class="fw-bold">¿Tienes dudas? Estamos aquí para ayudarte</h1>
      <p class="text-muted">Nuestro equipo está disponible para ayudarte con lo que necesites.</p>
    </div>

    <div class="row g-4">
      <!-- Formulario -->
      <div class="col-lg-7">
        <div class="card shadow border-0 p-4">
          
          <!-- Debug Info (remover en producción) -->
          <div class="alert alert-info" *ngIf="false">
            <small>
              Debug - Estado del formulario: {{ contactForm.valid ? 'Válido' : 'Inválido' }} | 
              Submitted: {{ isSubmitted }}
            </small>
          </div>

          <form [formGroup]="contactForm" (ngSubmit)="onSubmit()">
            
            <!-- Nombre -->
            <div class="mb-3">
              <label class="form-label">Nombre completo *</label>
              <input 
                type="text" 
                class="form-control"
                [class.is-invalid]="hasError('nombre')"
                [class.is-valid]="isValid('nombre')"
                formControlName="nombre"
                placeholder="Tu nombre completo">
              <div class="invalid-feedback" *ngIf="hasError('nombre')">
                {{ getErrorMessage('nombre') }}
              </div>
            </div>

            <!-- Correo -->
            <div class="mb-3">
              <label class="form-label">Correo electrónico *</label>
              <input 
                type="email" 
                class="form-control"
                [class.is-invalid]="hasError('correo')"
                [class.is-valid]="isValid('correo')"
                formControlName="correo"
                placeholder="tunombre@ejemplo.com">
              <div class="invalid-feedback" *ngIf="hasError('correo')">
                {{ getErrorMessage('correo') }}
              </div>
            </div>

            <!-- Teléfono -->
            <div class="mb-3">
              <label class="form-label">Teléfono (opcional)</label>
              <input 
                type="tel" 
                class="form-control"
                formControlName="telefono"
                placeholder="+57 300 123 4567">
              <small class="form-text text-muted">Opcional - nos ayuda a contactarte más rápido</small>
            </div>

            <!-- Cantidad -->
            <div class="mb-3">
              <label class="form-label">Número de dispositivos *</label>
              <input 
                type="number" 
                class="form-control"
                [class.is-invalid]="hasError('cantidad')"
                [class.is-valid]="isValid('cantidad')"
                formControlName="cantidad"
                placeholder="1, 2, 3, 4" 
                min="1" 
                max="50">
              <div class="invalid-feedback" *ngIf="hasError('cantidad')">
                {{ getErrorMessage('cantidad') }}
              </div>
            </div>

            <!-- Mensaje -->
            <div class="mb-4">
              <label class="form-label">Mensaje *</label>
              <textarea 
                class="form-control"
                [class.is-invalid]="hasError('mensaje')"
                [class.is-valid]="isValid('mensaje')"
                formControlName="mensaje"
                rows="4" 
                placeholder="Cuéntanos qué tipo de dispositivo tienes, qué problema presentas, etc."></textarea>
              <div class="invalid-feedback" *ngIf="hasError('mensaje')">
                {{ getErrorMessage('mensaje') }}
              </div>
              <small class="form-text text-muted">Mínimo 10 caracteres</small>
            </div>

            <!-- Botón de envío  -->
            <button 
              type="button" 
              [class]="buttonClass"
              [disabled]="!isFormValid"
              data-bs-toggle="modal" 
              [attr.data-bs-target]="isFormValid ? '#confirmModal' : null"
              (click)="!isFormValid && markAllFieldsTouched()">
              <i class="bi bi-send-fill me-2"></i>
              {{ buttonText }}
            </button>

            <!-- Indicador de campos obligatorios -->
            <small class="form-text text-muted mt-3 d-block text-center">
              <i class="bi bi-info-circle me-1"></i>
              Los campos marcados con * son obligatorios
            </small>

          </form>
        </div>
      </div>

      <!-- Información lateral -->
      <div class="col-lg-5">
        <div class="card border-0 shadow-sm p-4 h-100">
          <h5 class="mb-3"><i class="bi bi-telephone-fill me-2"></i>Contáctanos directamente</h5>
          <a 
            href="https://wa.me/573155210979?text=Hola%2C%20quiero%20más%20información%20sobre%20el%20restablecimiento%20de%20mi%20dispositivo%20Hikvision." 
            target="_blank" 
            class="btn btn-success mb-3">
            <i class="bi bi-whatsapp me-2"></i>WhatsApp
          </a>
          
          <a
            href="https://mail.google.com/mail/?view=cm&to=akilian182@gmail.com&su=Consulta%20Hikvision&body=Hola,%20necesito%20ayuda%20con%20mi%20dispositivo.%20Gracias."
            class="btn btn-primary mb-3"
            target="_blank">
            <i class="bi bi-envelope-fill me-2"></i>Correo (Gmail)
          </a>

          <hr>

          <h6 class="mt-4 mb-2"><i class="bi bi-clock-fill me-2"></i>Horario de atención</h6>
          <ul class="list-unstyled mb-3">
            <li><strong>Lunes a viernes:</strong> 8:00 AM – 12:00 PM / 1:30 PM - 4:00 PM</li>
            <li><strong>Sábados:</strong> Cerrado</li>
            <li><strong>Domingos y festivos:</strong> Cerrado</li>
          </ul>

          <div class="d-flex gap-3 mt-4">
            <a href="https://www.instagram.com/hik_nova/profilecard/?igsh=bnVrbnFseHZ2MG95" class="text-danger fs-4"><i class="bi bi-instagram"></i></a>
          </div>

          <small class="text-muted d-block mt-4">
            Tus datos serán tratados conforme a nuestra <a href="#footer" class="text-decoration-underline">política de privacidad</a>.
          </small>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Modal de confirmación -->
<div class="modal fade" id="confirmModal" tabindex="-1" aria-labelledby="confirmModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content p-4">
      <div class="modal-header border-0">
        <h5 class="modal-title" id="confirmModalLabel">
          <i class="bi bi-check-circle-fill text-success me-2"></i>
          ¿Cómo deseas contactarnos?
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body text-center">
        <p>Tu información está lista. Elige tu método preferido de contacto:</p>
        <div class="d-flex justify-content-center gap-3 flex-wrap">
          <button 
            type="button"
            class="btn btn-success"
            (click)="enviarWhatsApp()"
            data-bs-dismiss="modal">
            <i class="bi bi-whatsapp me-2"></i>WhatsApp
          </button>

          <button
            type="button"
            class="btn btn-primary"
            (click)="enviarCorreoSimple()"
            data-bs-dismiss="modal">
            <i class="bi bi-envelope-fill me-2"></i>Correo
          </button>
        </div>
        <small class="text-muted d-block mt-3">
          Se abrirá la aplicación correspondiente con tu información pre-cargada
        </small>
      </div>
    </div>
  </div>
</div>